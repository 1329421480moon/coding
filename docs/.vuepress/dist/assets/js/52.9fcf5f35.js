(window.webpackJsonp=window.webpackJsonp||[]).push([[52],{265:function(e,t,a){"use strict";a.r(t);var i=a(0),r=Object(i.a)({},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"图像处理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#图像处理","aria-hidden":"true"}},[e._v("#")]),e._v(" 图像处理")]),e._v(" "),a("blockquote",[a("p",[e._v("创作不易，转载请注明出处： 后盾人 @ houdurnen.com")])]),e._v(" "),a("h2",{attrs:{id:"配置环境"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置环境","aria-hidden":"true"}},[e._v("#")]),e._v(" 配置环境")]),e._v(" "),a("p",[e._v("PHP中图像处理需要GD库的支持。")]),e._v(" "),a("p",[e._v("在windows系统中修改php.ini文件，删除 extension=php_gd2.dll 前面的"),a("code",[e._v(";")]),e._v("开启图像处理支持。")]),e._v(" "),a("p",[e._v("centos中使用 "),a("code",[e._v("yum install php-gd*")])]),e._v(" "),a("p",[e._v("ubuntu系统中使用 "),a("code",[e._v("apt-get install php7.3-gd")])]),e._v(" "),a("p",[a("strong",[e._v("检测GD库是否加载")])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("$has = extension_loaded('GD');\nvar_dump($has);\n")])])]),a("h2",{attrs:{id:"使用方法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用方法","aria-hidden":"true"}},[e._v("#")]),e._v(" 使用方法")]),e._v(" "),a("p",[e._v("PHP创建图像步骤")]),e._v(" "),a("ol",[a("li",[e._v("发送HTTP头信息，声明内容为图像")]),e._v(" "),a("li",[e._v("创建画布")]),e._v(" "),a("li",[e._v("创建绘图所需要的颜色")]),e._v(" "),a("li",[e._v("绘图（填充画布、画圆、画方块、画线条、画布上写字）")]),e._v(" "),a("li",[e._v("输出图像")]),e._v(" "),a("li",[e._v("释放画布资源")])]),e._v(" "),a("h3",{attrs:{id:"头信息"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#头信息","aria-hidden":"true"}},[e._v("#")]),e._v(" 头信息")]),e._v(" "),a("p",[e._v("通过header() 函数告诉浏览器，输出的是一个图像而不是文本或HTML，这样浏览器就可以正常显示图像了。")]),e._v(" "),a("ul",[a("li",[e._v("header('Content-type:image/gif');")]),e._v(" "),a("li",[e._v("header('Content-type:image/jpeg');")]),e._v(" "),a("li",[e._v("header('Content-type:image/png');")])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("header('Content-type:image/jpeg');\nreadfile('user.jpeg');\n")])])]),a("h3",{attrs:{id:"创建画布"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建画布","aria-hidden":"true"}},[e._v("#")]),e._v(" 创建画布")]),e._v(" "),a("p",[e._v("imageCreateTrueColor(width,height)")]),e._v(" "),a("ul",[a("li",[e._v("传入的两个参数分别为画布的宽和高，在绘图时超出宽高的部分将不予显示，且此尺寸即为生成图片文件时的尺寸。")]),e._v(" "),a("li",[e._v("返回值为资源类型。")])]),e._v(" "),a("h3",{attrs:{id:"设置颜色"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#设置颜色","aria-hidden":"true"}},[e._v("#")]),e._v(" 设置颜色")]),e._v(" "),a("p",[e._v("imageColorAllocate(img_resource,R,G,B)")]),e._v(" "),a("ul",[a("li",[e._v("颜色从属于某个图像资源而存在。")]),e._v(" "),a("li",[e._v("颜色实际上是一个整形数值。")]),e._v(" "),a("li",[e._v("颜色的后三个参数需传入值的范围是0~255")])]),e._v(" "),a("h3",{attrs:{id:"填充颜色"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#填充颜色","aria-hidden":"true"}},[e._v("#")]),e._v(" 填充颜色")]),e._v(" "),a("p",[e._v("imageFill(img_resource,x,y,color)")]),e._v(" "),a("ul",[a("li",[e._v("(x,y)表示从哪个点开始填充颜色的坐标")]),e._v(" "),a("li",[e._v("不填充画布的话，默认是黑色")])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("header('Content-type:image/jpeg');\n$res = imagecreatetruecolor(1000, 500);\n$red = imagecolorallocate($res, 255, 0, 0);\nimagefill($res, 0, 0, $red);\nimagejpeg($res);\n")])])]),a("h3",{attrs:{id:"绘制矩形"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#绘制矩形","aria-hidden":"true"}},[e._v("#")]),e._v(" 绘制矩形")]),e._v(" "),a("p",[a("strong",[e._v("绘制空心矩形")])]),e._v(" "),a("ul",[a("li",[e._v("imageRectangle(img_res,x1,y1,x2,y2,color)")])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("header('Content-type:image/jpeg');\n$res = imagecreatetruecolor(1000, 500);\n$red = imagecolorallocate($res, 255, 0, 0);\n$green = imagecolorallocate($res, 0, 255, 0);\nimagefill($res, 0, 0, $red);\nimagerectangle($res, 100, 100, 200, 200, $green);\nimagejpeg($res);\n")])])]),a("p",[a("strong",[e._v("绘制填充好的实心矩形")])]),e._v(" "),a("p",[e._v("imageFilledRectangle (img_res,x1,y1,x2,y2,color)")]),e._v(" "),a("ul",[a("li",[e._v("(x1,y1)为左上角坐标， (x2,y2)为右下角坐标")])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("header('Content-type:image/jpeg');\n$res = imagecreatetruecolor(1000, 500);\n$red = imagecolorallocate($res, 255, 0, 0);\n$green = imagecolorallocate($res, 0, 255, 0);\nimagefill($res, 0, 0, $red);\nimagefilledrectangle($res, 100, 100, 300, 300, $green);\nimagejpeg($res);\n")])])]),a("h3",{attrs:{id:"绘制圆形"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#绘制圆形","aria-hidden":"true"}},[e._v("#")]),e._v(" 绘制圆形")]),e._v(" "),a("p",[e._v("绘制空心圆形")]),e._v(" "),a("ul",[a("li",[e._v("imageEllipse(img_res,x,y,w,h,color)")])]),e._v(" "),a("p",[e._v("绘制填充好的实心圆")]),e._v(" "),a("ul",[a("li",[e._v("imageFilledEllipse(img_res,x,y,w,h,color)")])]),e._v(" "),a("p",[e._v("说明：")]),e._v(" "),a("ul",[a("li",[e._v("(x,y)为圆心坐标。 w为宽度，h为高度")])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("header('Content-type:image/jpeg');\n$res = imagecreatetruecolor(500, 500);\n$red = imagecolorallocate($res, 255, 0, 0);\n$green = imagecolorallocate($res, 0, 255, 0);\nimagefill($res, 0, 0, $red);\nimageellipse($res, 250, 250, 100, 100, $green);\nimagejpeg($res);\n")])])]),a("h3",{attrs:{id:"绘制线条"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#绘制线条","aria-hidden":"true"}},[e._v("#")]),e._v(" 绘制线条")]),e._v(" "),a("p",[e._v("imageLine(img_res,x1,y1,x2,y2,color)")]),e._v(" "),a("ul",[a("li",[e._v("(x1,y1)为起始点坐标")]),e._v(" "),a("li",[e._v("(x2,y2)为结束点坐标")])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("$res = imagecreatetruecolor(500, 500);\n$red = imagecolorallocate($res, 255, 0, 0);\n$green = imagecolorallocate($res, 0, 255, 0);\nimagefill($res, 0, 0, $red);\nimageline($res, 0, 0, 499, 499, $green);\nimagepng($res);\n")])])]),a("h3",{attrs:{id:"绘制像素"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#绘制像素","aria-hidden":"true"}},[e._v("#")]),e._v(" 绘制像素")]),e._v(" "),a("p",[e._v("bool imagesetpixel ( resource $image , int $x , int $y , int $color )")]),e._v(" "),a("ul",[a("li",[e._v("(x1,y1)为点坐标")])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("header('Content-type:image/jpeg');\n$res = imagecreatetruecolor(500, 500);\n$red = imagecolorallocate($res, 255, 0, 0);\n$green = imagecolorallocate($res, 0, 255, 0);\nimagefill($res, 0, 0, $red);\nfor ($i = 0; $i < 600; $i++) {\n    imagesetpixel($res, mt_rand(0, 500), mt_rand(0, 500), $green);\n}\nimagepng($res);\n")])])]),a("h3",{attrs:{id:"输出图像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#输出图像","aria-hidden":"true"}},[e._v("#")]),e._v(" 输出图像")]),e._v(" "),a("p",[e._v("输出不同格式的图像用不同的方法：")]),e._v(" "),a("ul",[a("li",[e._v("imagegif(img_resource[,filename])")]),e._v(" "),a("li",[e._v("imagejpeg(img_resource[,filename])")]),e._v(" "),a("li",[e._v("imagepng(img_resource[,filename])")]),e._v(" "),a("li",[e._v("imagebmp(img_resource[,filename])")]),e._v(" "),a("li",[e._v("当设置第二个参数时表示储存文件，如果存在同名文件会覆盖")])]),e._v(" "),a("h3",{attrs:{id:"释放图像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#释放图像","aria-hidden":"true"}},[e._v("#")]),e._v(" 释放图像")]),e._v(" "),a("p",[e._v("imageDestroy(img_resource)")]),e._v(" "),a("ul",[a("li",[e._v("图像输出完毕及时释放资源，把内存空间留给更需要的程序。")])]),e._v(" "),a("h3",{attrs:{id:"输入文本"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#输入文本","aria-hidden":"true"}},[e._v("#")]),e._v(" 输入文本")]),e._v(" "),a("p",[e._v("array imagettftext ( resource $image , float $size , float $angle , int $x , int $y , int $color , string $fontfile , string $text )")]),e._v(" "),a("ul",[a("li",[e._v("参数说明：图像资源，字体尺寸，角度，第一个字符的基本点（大概是字符的左下角），Y 坐标（字体基线的位置），颜色 ，字体文件，文本字符串（UTF-8 编码）")])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("header('Content-type:image/png');\n$res = imagecreatetruecolor(500, 500);\n$red = imagecolorallocate($res, 255, 0, 0);\n$green = imagecolorallocate($res, 0, 255, 0);\nimagefill($res, 0, 0, $red);\n$font = realpath('source.otf');\nimagettftext($res, 50, 0, 0, 50, $green, $font, 'houdunren.com');\nimagepng($res);\nimagedestroy($res);\n")])])]),a("p",[e._v("array imagettfbbox ( float $size , float $angle , string $fontfile , string $text )")]),e._v(" "),a("ul",[a("li",[e._v("文本范围的盒子大小，可以方便控制文本输出位置")]),e._v(" "),a("li",[e._v("返回一个含有 8 个单元的数组表示了文本外框的四个角：")])]),e._v(" "),a("table",[a("thead",[a("tr",[a("th",[e._v("变量")]),e._v(" "),a("th",[e._v("位置")])])]),e._v(" "),a("tbody",[a("tr",[a("td",[e._v("0")]),e._v(" "),a("td",[e._v("左下角 X 位置")])]),e._v(" "),a("tr",[a("td",[e._v("1")]),e._v(" "),a("td",[e._v("左下角 Y 位置")])]),e._v(" "),a("tr",[a("td",[e._v("2")]),e._v(" "),a("td",[e._v("右下角 X 位置")])]),e._v(" "),a("tr",[a("td",[e._v("3")]),e._v(" "),a("td",[e._v("右下角 Y 位置")])]),e._v(" "),a("tr",[a("td",[e._v("4")]),e._v(" "),a("td",[e._v("右上角 X 位置")])]),e._v(" "),a("tr",[a("td",[e._v("5")]),e._v(" "),a("td",[e._v("右上角 Y 位置")])]),e._v(" "),a("tr",[a("td",[e._v("6")]),e._v(" "),a("td",[e._v("左上角 X 位置")])]),e._v(" "),a("tr",[a("td",[e._v("7")]),e._v(" "),a("td",[e._v("左上角 Y 位置")])])])]),e._v(" "),a("p",[e._v("文字在画布右上角显示")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("$font = realpath('source.otf');\n$text = 'houdunren.com';\n$size = 16;\n$box = imagettfbbox($size, 0, $font, 'houdunren.com');\n$width  = $box[2] - $box[0];\n$height = $box[0] - $box[7];\nimagettftext($res, $size, 0, 500 - $width, $height, $green, $font, 'houdunren.com');\n")])])]),a("p",[e._v("文字在画布中间显示")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("...\nimagettftext($res, $size, 0, 250 - $width / 2, 250 - $height / 2, $green, $font, 'houdunren.com');\n...\n")])])]),a("h3",{attrs:{id:"外部图像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#外部图像","aria-hidden":"true"}},[e._v("#")]),e._v(" 外部图像")]),e._v(" "),a("p",[e._v("打开图片文件")]),e._v(" "),a("ul",[a("li",[e._v("imageCreateFromgif(filename/url)")]),e._v(" "),a("li",[e._v("imageCreateFromjpeg(filename/url)")]),e._v(" "),a("li",[e._v("imageCreateFrompng(filename/url)")]),e._v(" "),a("li",[e._v("imageCreateFrombmp(filename/url)")]),e._v(" "),a("li",[e._v("返回一个资源类型")])]),e._v(" "),a("h3",{attrs:{id:"获得信息"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#获得信息","aria-hidden":"true"}},[e._v("#")]),e._v(" 获得信息")]),e._v(" "),a("p",[e._v("imagesx(img_resource)")]),e._v(" "),a("ul",[a("li",[e._v("取得图像宽度")])]),e._v(" "),a("p",[e._v("imagesy(img_resource)")]),e._v(" "),a("ul",[a("li",[e._v("取得图像高度")])]),e._v(" "),a("p",[e._v("getimagesize(img_file)")]),e._v(" "),a("ul",[a("li",[e._v("array getimagesize ( string $filename [, array &$imageinfo ] )")])]),e._v(" "),a("h3",{attrs:{id:"图像复制"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#图像复制","aria-hidden":"true"}},[e._v("#")]),e._v(" 图像复制")]),e._v(" "),a("p",[e._v("拷贝图像的一部分")]),e._v(" "),a("ul",[a("li",[e._v("bool imagecopy ( resource $dst_im , resource $src_im , int $dst_x , int $dst_y , int $src_x , int $src_y , int $src_w , int $src_h )")])]),e._v(" "),a("p",[e._v("拷贝并合并图像的一部分")]),e._v(" "),a("ul",[a("li",[e._v("bool imagecopymerge ( resource $dst_im , resource $src_im , int $dst_x , int $dst_y , int $src_x , int $src_y , int $src_w , int $src_h , int $pct )")])]),e._v(" "),a("h3",{attrs:{id:"图片缩放"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#图片缩放","aria-hidden":"true"}},[e._v("#")]),e._v(" 图片缩放")]),e._v(" "),a("p",[e._v("拷贝部分图像并调整大小")]),e._v(" "),a("ul",[a("li",[e._v("bool imagecopyresampled ( resource $dst_image , resource $src_image , int $dst_x , int $dst_y , int $src_x , int $src_y , int $dst_w , int $dst_h , int $src_w , int $src_h )")])]),e._v(" "),a("h2",{attrs:{id:"验证码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#验证码","aria-hidden":"true"}},[e._v("#")]),e._v(" 验证码")]),e._v(" "),a("p",[e._v("使用方法")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('# 后台code.php\ninclude \'Captcha.php\';\n$code = new Captcha(100, 30, 20);\n$code->make();\n\n# 前台\n<img src="code.php" alt="">\n')])])]),a("p",[e._v("验证码类")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("<?php\nclass Captcha\n{\n    protected $width;\n    protected $height;\n    protected $res;\n    protected $len = 4;\n    protected $font;\n    protected $size;\n    public function __construct(int $width = 100, int $height = 30, $size = 20)\n    {\n        $this->width = $width;\n        $this->height = $height;\n        $this->font = realpath('source.otf');\n        $this->size = $size;\n    }\n    public function make()\n    {\n        $res = imagecreatetruecolor($this->width, $this->height);\n        imagefill($this->res = $res, 0, 0, imagecolorallocate($res, 200, 200, 200));\n        $this->text();\n        $this->line();\n        $this->pix();\n        $this->render();\n    }\n    protected function text()\n    {\n        $text = 'abcdefghigk123456789';\n\n        for ($i = 0; $i < $this->len; $i++) {\n            $x = $this->width / $this->len * $i;\n            $box = imagettfbbox($this->size, 0, $this->font, $text[$i]);\n            imagettftext(\n                $this->res,\n                $this->size,\n                mt_rand(-20, 20),\n                $x,\n                $this->height / 2 + ($box[0] - $box[7]) / 2,\n                $this->textColor(),\n                $this->font,\n                strtoupper($text[$i])\n            );\n        }\n    }\n    protected function pix()\n    {\n        for ($i = 0; $i < 300; $i++) {\n            imagesetpixel(\n                $this->res,\n                mt_rand(0, $this->width),\n                mt_rand(0, $this->height),\n                $this->color()\n            );\n        }\n    }\n    protected function line()\n    {\n        for ($i = 0; $i < 6; $i++) {\n            imagesetthickness($this->res, mt_rand(1, 3));\n            imageline(\n                $this->res,\n                mt_rand(0, $this->width),\n                mt_rand(0, $this->height),\n                mt_rand(0, $this->width),\n                mt_rand(0, $this->height),\n                $this->color()\n            );\n        }\n    }\n    protected function color()\n    {\n        return imagecolorallocate($this->res, mt_rand(100, 200), mt_rand(100, 200), mt_rand(100, 200));\n    }\n    protected function textColor()\n    {\n        return imagecolorallocate($this->res, mt_rand(50, 150), mt_rand(50, 150), mt_rand(50, 150));\n    }\n    protected function render()\n    {\n        header('Content-type:image/png');\n        imagepng($this->res);\n    }\n}\n")])])]),a("h2",{attrs:{id:"水印类"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#水印类","aria-hidden":"true"}},[e._v("#")]),e._v(" 水印类")]),e._v(" "),a("p",[e._v("调用方式")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("<?php\ninclude \"Water.php\";\n$water = new Water(\"logo.png\");\n$water->make('sun.png', '2.png', 5);\n")])])]),a("p",[e._v("水印类源码")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("<?php\nclass Water\n{\n    //水印资源\n    protected $water;\n    //水印图片\n    public function __construct(string $water)\n    {\n        $this->water = $water;\n    }\n    //入口方法\n    public function make(string $image, string $filename = null, int $pos = 9)\n    {\n        $res = $this->resource($image);\n        $water = $this->resource($this->water);\n        $postion = $this->position($res, $water, $pos);\n        imagecopy($res, $water,  $postion['x'], $postion['y'], 0, 0, imagesx($water), imagesy($water));\n        $this->showAction($image)($res, $filename ?: $image);\n    }\n    //获取资源对象\n    protected function resource($image)\n    {\n        $info = getimagesize($image);\n        $function = [1 => 'imagecreatefromgif', 2 => 'imagecreatefromjpeg', 3 => 'imagecreatefrompng'];\n        $call = $function[$info[2]];\n        return $call($image);\n    }\n    //根据类型输出图片\n    protected function showAction(string $image)\n    {\n        $info = getimagesize($image);\n        $function = [1 => 'imagegif', 2 => 'imagejpeg', 3 => 'imagepng'];\n        return $function[$info[2]];\n    }\n    //位置\n    protected function position($des,  $res, int $pos)\n    {\n        $info = ['x' => 0, 'y' => 0];\n        switch ($pos) {\n            case 1:\n                break;\n            case 2:\n                $info['x'] = (imagesx($des) - imagesx($res)) / 2;\n                break;\n            case 3:\n                $info['x'] = (imagesx($des) - imagesx($res));\n                break;\n            case 4:\n                $info['y'] = (imagesy($des) - imagesy($res)) / 2;\n                break;\n            case 5:\n                $info['x'] = (imagesx($des) - imagesx($res)) / 2;\n                $info['y'] = (imagesy($des) - imagesy($res)) / 2;\n                break;\n        }\n        return $info;\n    }\n}\n")])])]),a("h2",{attrs:{id:"缩略图"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#缩略图","aria-hidden":"true"}},[e._v("#")]),e._v(" 缩略图")]),e._v(" "),a("p",[e._v("调用方式")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("include 'Resize.php';\n$image =  new Resize;\n\n$image->make('sun.png', '1.jpeg', 200, 200, 3);\n")])])]),a("p",[e._v("缩略图类源码")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("<?php\nclass Resize\n{\n    public function make(string $file, string $to = null, int $width = 200, int $height = 200, int $type = 3)\n    {\n        $image = $this->resource($file);\n        $info = $this->size($width, $height, imagesx($image), imagesy($image), $type);\n        $res = imagecreatetruecolor($info[0], $info[1]);\n        imagecopyresampled($res, $image, 0, 0, 0, 0, $info[0], $info[1], $info[2], $info[3]);\n        header('Content-type:image/jpeg');\n        imagejpeg($res);\n    }\n    protected function size($rw, $rh, $iw, $ih, int $type)\n    {\n        switch ($type) {\n            case 1:\n                //固定宽度，高度自动\n                $rh = $rw / $iw * $ih;\n                break;\n            case 2:\n                //高度固定，宽度自动 \n                $rw = $rh / $ih * $iw;\n                break;\n            case 3:\n                //固定宽度，高度裁切\n                $ih = $iw / $rw * $rh;\n                break;\n            default:\n                if (($iw / $rw) > ($ih / $rh)) {\n                    $iw = $ih / $rh * $rh;\n                } else {\n                    $ih = $iw / $rw * $rw;\n                }\n        }\n\n        return [$rw, $rh, $iw, $ih];\n    }\n    protected function resource(string $image)\n    {\n        if (!file_exists($image) || getimagesize($image) === false) {\n            throw new Exception(\"file dont exists or it's not an image file\");\n        }\n        $functions = [1 => 'imagecreatefromgif', 2 => 'imagecreatefromjpeg', 3 => 'imagecreatefrompng'];\n        $info = getimagesize($image);\n        $call = $functions[$info[2]];\n        return $call($image);\n    }\n}\n")])])])])},[],!1,null,null,null);t.default=r.exports}}]);