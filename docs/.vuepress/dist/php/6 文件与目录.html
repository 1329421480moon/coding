<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>文件与目录 | 后盾人</title>
    <meta name="description" content="在线文档库">
    
    
    <link rel="preload" href="/assets/css/0.styles.c077566e.css" as="style"><link rel="preload" href="/assets/js/app.bc65c992.js" as="script"><link rel="preload" href="/assets/js/2.80ecb150.js" as="script"><link rel="preload" href="/assets/js/51.c0bb3a53.js" as="script"><link rel="prefetch" href="/assets/js/10.5df46fff.js"><link rel="prefetch" href="/assets/js/11.48a151ca.js"><link rel="prefetch" href="/assets/js/12.4d47eb83.js"><link rel="prefetch" href="/assets/js/13.bfdf78e5.js"><link rel="prefetch" href="/assets/js/14.bf103f7a.js"><link rel="prefetch" href="/assets/js/15.2afbbcb3.js"><link rel="prefetch" href="/assets/js/16.4cd32149.js"><link rel="prefetch" href="/assets/js/17.b700a578.js"><link rel="prefetch" href="/assets/js/18.841cb9aa.js"><link rel="prefetch" href="/assets/js/19.9d9f94d9.js"><link rel="prefetch" href="/assets/js/20.61b85b80.js"><link rel="prefetch" href="/assets/js/21.923f94f8.js"><link rel="prefetch" href="/assets/js/22.d5562ad3.js"><link rel="prefetch" href="/assets/js/23.da1f1894.js"><link rel="prefetch" href="/assets/js/24.9353d167.js"><link rel="prefetch" href="/assets/js/25.77478037.js"><link rel="prefetch" href="/assets/js/26.cdf76f4a.js"><link rel="prefetch" href="/assets/js/27.d3cd261a.js"><link rel="prefetch" href="/assets/js/28.79c63787.js"><link rel="prefetch" href="/assets/js/29.eb6afccd.js"><link rel="prefetch" href="/assets/js/3.a4a23afb.js"><link rel="prefetch" href="/assets/js/30.91ff8b2f.js"><link rel="prefetch" href="/assets/js/31.b16b1116.js"><link rel="prefetch" href="/assets/js/32.0395ed50.js"><link rel="prefetch" href="/assets/js/33.c5fcd202.js"><link rel="prefetch" href="/assets/js/34.a87b23ee.js"><link rel="prefetch" href="/assets/js/35.ecf438c5.js"><link rel="prefetch" href="/assets/js/36.7e4a9a69.js"><link rel="prefetch" href="/assets/js/37.7f5e6d33.js"><link rel="prefetch" href="/assets/js/38.83fa0769.js"><link rel="prefetch" href="/assets/js/39.c1cab2ae.js"><link rel="prefetch" href="/assets/js/4.993959b0.js"><link rel="prefetch" href="/assets/js/40.3b2fe4ca.js"><link rel="prefetch" href="/assets/js/41.6e554ce2.js"><link rel="prefetch" href="/assets/js/42.0967e072.js"><link rel="prefetch" href="/assets/js/43.01556904.js"><link rel="prefetch" href="/assets/js/44.d34233e4.js"><link rel="prefetch" href="/assets/js/45.42cc2442.js"><link rel="prefetch" href="/assets/js/46.11d8c521.js"><link rel="prefetch" href="/assets/js/47.fe22e45f.js"><link rel="prefetch" href="/assets/js/48.9ca44d94.js"><link rel="prefetch" href="/assets/js/49.a06be935.js"><link rel="prefetch" href="/assets/js/5.66cd6dad.js"><link rel="prefetch" href="/assets/js/50.fb75075e.js"><link rel="prefetch" href="/assets/js/52.bf242e2c.js"><link rel="prefetch" href="/assets/js/53.d665c82a.js"><link rel="prefetch" href="/assets/js/54.1349cf82.js"><link rel="prefetch" href="/assets/js/55.190117ab.js"><link rel="prefetch" href="/assets/js/56.9969dd76.js"><link rel="prefetch" href="/assets/js/57.d3149c8c.js"><link rel="prefetch" href="/assets/js/58.abe18fea.js"><link rel="prefetch" href="/assets/js/59.d5702c5c.js"><link rel="prefetch" href="/assets/js/6.05e78c64.js"><link rel="prefetch" href="/assets/js/60.7516fee0.js"><link rel="prefetch" href="/assets/js/61.f4d2ce2e.js"><link rel="prefetch" href="/assets/js/62.e37e41c1.js"><link rel="prefetch" href="/assets/js/63.089ce7c2.js"><link rel="prefetch" href="/assets/js/64.0df933c0.js"><link rel="prefetch" href="/assets/js/7.3397dc85.js"><link rel="prefetch" href="/assets/js/8.6550e0d8.js"><link rel="prefetch" href="/assets/js/9.a90cc6fb.js">
    <link rel="stylesheet" href="/assets/css/0.styles.c077566e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">后盾人</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">文档列表</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/php/1 前言.html" class="nav-link">PHP</a></li><li class="dropdown-item"><!----> <a href="/linux/ubuntu.html" class="nav-link">Linux</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">在线学习</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://www.houdunren.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  在线教育
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.houdunren.com/edu/front/system?sid=1&amp;mid=2" target="_blank" rel="noopener noreferrer" class="nav-link external">
  系统学习
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.houdunren.com/edu/front/lesson?sid=1&amp;mid=2" target="_blank" rel="noopener noreferrer" class="nav-link external">
  实战课程
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.houdunren.com/edu/front/video?sid=1&amp;mid=2" target="_blank" rel="noopener noreferrer" class="nav-link external">
  最近更新
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.houdunren.com/edu/front/topic" target="_blank" rel="noopener noreferrer" class="nav-link external">
  话题讨论
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.houdunren.com/edu/front/sign" target="_blank" rel="noopener noreferrer" class="nav-link external">
  签到打卡
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div><div class="nav-item"><a href="https://www.houdunren.com/edu/front/live" target="_blank" rel="noopener noreferrer" class="nav-link external">
  八点直播
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://gitee.com/houdunren/code" target="_blank" rel="noopener noreferrer" class="repo-link">
    查看源码
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">文档列表</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/php/1 前言.html" class="nav-link">PHP</a></li><li class="dropdown-item"><!----> <a href="/linux/ubuntu.html" class="nav-link">Linux</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">在线学习</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://www.houdunren.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  在线教育
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.houdunren.com/edu/front/system?sid=1&amp;mid=2" target="_blank" rel="noopener noreferrer" class="nav-link external">
  系统学习
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.houdunren.com/edu/front/lesson?sid=1&amp;mid=2" target="_blank" rel="noopener noreferrer" class="nav-link external">
  实战课程
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.houdunren.com/edu/front/video?sid=1&amp;mid=2" target="_blank" rel="noopener noreferrer" class="nav-link external">
  最近更新
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.houdunren.com/edu/front/topic" target="_blank" rel="noopener noreferrer" class="nav-link external">
  话题讨论
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.houdunren.com/edu/front/sign" target="_blank" rel="noopener noreferrer" class="nav-link external">
  签到打卡
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div><div class="nav-item"><a href="https://www.houdunren.com/edu/front/live" target="_blank" rel="noopener noreferrer" class="nav-link external">
  八点直播
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://gitee.com/houdunren/code" target="_blank" rel="noopener noreferrer" class="repo-link">
    查看源码
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/php/1 前言.html" class="sidebar-link">1 前言</a></li><li><a href="/php/2 基础知识.html" class="sidebar-link">2 基础知识</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="文件与目录"><a href="#文件与目录" aria-hidden="true" class="header-anchor">#</a> 文件与目录</h1> <blockquote><p>创作不易，转载请注明出处： 后盾人 @ houdurnen.com</p></blockquote> <p>PHP提供了完善的操作文件与目录机制。</p> <h2 id="基础函数"><a href="#基础函数" aria-hidden="true" class="header-anchor">#</a> 基础函数</h2> <h3 id="disk-total-space"><a href="#disk-total-space" aria-hidden="true" class="header-anchor">#</a> disk_total_space</h3> <p>本函数返回的是该目录所在的磁盘分区的总大小，因此在给出同一个磁盘分区的不同目录作为参数所得到的结果完全相同。</p> <h3 id="disk-free-space"><a href="#disk-free-space" aria-hidden="true" class="header-anchor">#</a> disk_free_space</h3> <p>参数是一个目录的字符串。该函数将根据相应的文件系统或磁盘分区返回可用的字节数。</p> <h3 id="自动添加单位"><a href="#自动添加单位" aria-hidden="true" class="header-anchor">#</a> 自动添加单位</h3> <div class="language- extra-class"><pre class="language-text"><code>/**
 * 获取有单位的大小
 * @param int $total 大小单位字节
 * @return string|null
 */
function space_total(int $total): ?string
{
    $config = [3 =&gt; 'GB', 2 =&gt; 'MB', 1 =&gt; 'KB'];
    foreach ($config as $num =&gt; $unit) {
        if ($total &gt; pow(1024, $num)) {
            return round($total / pow(1024, $num)) . $unit;
        }
    }
    return '0KB';
}

echo space_total(disk_total_space('.'));
</code></pre></div><h3 id="filesize"><a href="#filesize" aria-hidden="true" class="header-anchor">#</a> filesize</h3> <p>取得指定文件的大小。</p> <div class="language- extra-class"><pre class="language-text"><code>$filename = 'somefile.txt';
echo $filename . ': ' . filesize($filename) . ' bytes';
</code></pre></div><h3 id="fopen"><a href="#fopen" aria-hidden="true" class="header-anchor">#</a> fopen</h3> <p>打开文件或者 URL。如果打开的是URL需要保证PHP.INI配置项<code>allow_url_fopen</code> 开启。</p> <p>在操作二进制文件时如果没有指定 <em>'b'</em> 标记，可能会碰到一些奇怪的问题，包括坏掉的图片文件以及关于 <em>\r\n</em> 字符的奇怪问题。</p> <table><thead><tr><th><strong>mode</strong></th> <th><strong>说明</strong></th></tr></thead> <tbody><tr><td><em>'r'</em></td> <td>只读方式打开，将文件指针指向文件头。</td></tr> <tr><td><em>'r+'</em></td> <td>读写方式打开，将文件指针指向文件头。</td></tr> <tr><td><em>'w'</em></td> <td>写入方式打开，将文件指针指向文件头并将文件大小截为零。如果文件不存在则尝试创建之。</td></tr> <tr><td><em>'w+'</em></td> <td>读写方式打开，将文件指针指向文件头并将文件大小截为零。如果文件不存在则尝试创建之。</td></tr> <tr><td><em>'a'</em></td> <td>写入方式打开，将文件指针指向文件末尾。如果文件不存在则尝试创建之。</td></tr> <tr><td><em>'a+'</em></td> <td>读写方式打开，将文件指针指向文件末尾。如果文件不存在则尝试创建之。</td></tr> <tr><td><em>'x'</em></td> <td>创建并以写入方式打开，将文件指针指向文件头。如果文件已存在，则 <strong>fopen()</strong> 调用失败并返回 <strong>FALSE</strong>，并生成一条 <strong>E_WARNING</strong> 级别的错误信息。如果文件不存在则尝试创建之。</td></tr> <tr><td><em>'x+'</em></td> <td>创建并以读写方式打开，其他的行为和 <em>'x'</em> 一样。</td></tr></tbody></table> <h3 id="fread"><a href="#fread" aria-hidden="true" class="header-anchor">#</a> fread</h3> <p>返回所读取的字符串， 或者在失败时返回 <strong>FALSE</strong>。</p> <div class="language- extra-class"><pre class="language-text"><code>$filename = 'a.txt';
$handle = fopen($filename,'r');
echo fread($handle,filesize($filename));
</code></pre></div><h3 id="fseek"><a href="#fseek" aria-hidden="true" class="header-anchor">#</a> fseek</h3> <p>在文件指针中定位，注意移动到 EOF 之后的位置不算错误。</p> <div class="language- extra-class"><pre class="language-text"><code>$filename = 'a.txt';//a.txt内容为 abc
$handle = fopen($filename, 'r+');
fseek($handle, 1);
//移动指针后读取为bc
echo fread($handle, filesize($filename));
</code></pre></div><h3 id="fwrite"><a href="#fwrite" aria-hidden="true" class="header-anchor">#</a> fwrite</h3> <p>写入文件，返回写入的字符数，出现错误时则返回 <strong>FALSE</strong> 。</p> <p>在区分二进制文件和文本文件的系统上（如 Windows） 打开文件时，<a href="https://www.php.net/manual/zh/function.fopen.php" target="_blank" rel="noopener noreferrer">fopen()<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 函数的 mode 参数要加上 'b'。</p> <div class="language- extra-class"><pre class="language-text"><code>$handle = fopen('xj.txt','r+');
fwrite($handle,'aa');
fseek($handle,0);
echo fread($handle,999);
</code></pre></div><h3 id="fclose"><a href="#fclose" aria-hidden="true" class="header-anchor">#</a> fclose</h3> <p>fclose — 关闭一个已打开的文件指针</p> <div class="language- extra-class"><pre class="language-text"><code>$handle = fopen('somefile.txt', 'r');
fclose($handle);
</code></pre></div><h3 id="feof"><a href="#feof" aria-hidden="true" class="header-anchor">#</a> feof</h3> <p>测试文件指针是否到了文件结束的位置</p> <div class="language- extra-class"><pre class="language-text"><code>$handle = fopen('xj.txt','rb');
while(!feof($handle)){
    echo fread($handle,1);
}
</code></pre></div><h3 id="fgetc"><a href="#fgetc" aria-hidden="true" class="header-anchor">#</a> fgetc</h3> <p>读取一个字符</p> <div class="language- extra-class"><pre class="language-text"><code>$handle = fopen('xj.txt','rb');
while($c = fgetc($handle))
	echo $c;
</code></pre></div><h3 id="fgets"><a href="#fgets" aria-hidden="true" class="header-anchor">#</a> fgets</h3> <p>读取一行内容</p> <div class="language- extra-class"><pre class="language-text"><code>$handle = fopen('xj.txt','rb');
while($c = fgets($handle))
	echo $c;
</code></pre></div><h3 id="fgetss"><a href="#fgetss" aria-hidden="true" class="header-anchor">#</a> fgetss</h3> <p>从文件指针中读取一行并过滤掉 HTML 标记。</p> <p>参数分别表示：资源对象、读取数量、允许标签。</p> <div class="language- extra-class"><pre class="language-text"><code>$handle = fopen('xj.html','rb');
while(!feof($handle)){
    echo fgetss($handle,20,'&lt;h1&gt;&lt;title&gt;');
}
</code></pre></div><h3 id="fgetcsv"><a href="#fgetcsv" aria-hidden="true" class="header-anchor">#</a> fgetcsv</h3> <p>从文件指针中读入一行并解析 CSV 字段。</p> <div class="language- extra-class"><pre class="language-text"><code>$handle = fopen('user.csv','rb');
$users = fgetcsv($handle,0,',');
print_r($users);
</code></pre></div><h3 id="readfile"><a href="#readfile" aria-hidden="true" class="header-anchor">#</a> readfile</h3> <p>读取文件所有内容</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;?php
header('Content-type:image/jpeg');
readfile('user.jpeg');
</code></pre></div><h3 id="flock"><a href="#flock" aria-hidden="true" class="header-anchor">#</a> flock</h3> <p>锁定文件操作，如果使用<code>flock</code> 锁定文件，必须保证在所有使用文件地方执行 <code>flock</code> 才有意义。如果过早的系统因为不支持锁定操作，函数执行将没有效果如FAT系统。</p> <table><thead><tr><th>锁定方式</th> <th>说明</th></tr></thead> <tbody><tr><td><strong>LOCK_SH</strong></td> <td>取得共享锁定（读取的程序）</td></tr> <tr><td><strong>LOCK_EX</strong></td> <td>取得独占锁定（写入的程序)</td></tr> <tr><td><strong>LOCK_UN</strong></td> <td>释放锁定（无论共享或独占）</td></tr> <tr><td><strong>LOCK_NB</strong></td> <td>无法建立锁定时，此操作可不被阻断，马上返回进程。通常与LOCK_SH或LOCK_EX 做OR(|）组合使用。（Windows 系统上还不支持）</td></tr></tbody></table> <h4 id="读锁"><a href="#读锁" aria-hidden="true" class="header-anchor">#</a> 读锁</h4> <p>1.php 文件内容：</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;?php
$handle = fopen('xj.txt','rb');
$stat = flock($handle,LOCK_SH);
sleep(5);
echo fgetss($handle);
flock($handle,LOCK_UN);
</code></pre></div><p>2.php</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;?php
$handle = fopen('xj.txt','rb');
$stat = flock($handle,LOCK_SH);
echo fgetss($handle);
flock($handle,LOCK_UN);
</code></pre></div><p>读锁不能写入文件可以读取文件，并不会阻塞。</p> <h4 id="写锁"><a href="#写锁" aria-hidden="true" class="header-anchor">#</a> 写锁</h4> <p>1.php 文件内容：</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;?php
$handle = fopen('xj.txt','rb');
$stat = flock($handle,LOCK_EX);
sleep(5);
echo fgetss($handle);
flock($handle,LOCK_UN);
</code></pre></div><p>2.php</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;?php
$handle = fopen('xj.txt','rb');
$stat = flock($handle,LOCK_SH);
echo fgetss($handle);
flock($handle,LOCK_UN);
</code></pre></div><p>写锁为独占，所以读取文件也会阻塞，前一个文件执行完后才可以执行第二个。</p> <h4 id="防止阻塞"><a href="#防止阻塞" aria-hidden="true" class="header-anchor">#</a> 防止阻塞</h4> <p>1.php</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;?php
$handle = fopen('xj.txt','ab');
$stat = flock($handle,LOCK_EX);
sleep(5);
echo fgetss($handle);
flock($handle,LOCK_UN);
</code></pre></div><p>2.php</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;?php
$handle = fopen('xj.txt','ab');
$stat = flock($handle,LOCK_SH | LOCK_NB,$wouldblock);
if($stat){
    $d = fwrite($handle,'aoxiangjun.com');
    echo fgetss($handle);
}else{
    echo 'file is locked';
}
flock($handle,LOCK_UN);
</code></pre></div><ul><li>使用LOCK_NB当文件被其他请求锁定时，脚本继续向下执行，锁定失败。</li> <li>阻塞时 $wouldblock 亦是为真</li></ul> <h3 id="is-writable"><a href="#is-writable" aria-hidden="true" class="header-anchor">#</a> is_writable</h3> <p>判断给定的文件名是否可写</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;?php
$filename = 'test.txt';
if (is_writable($filename)) {
    echo 'The file is writable';
} else {
    echo 'The file is not writable';
}
</code></pre></div><h3 id="is-readable"><a href="#is-readable" aria-hidden="true" class="header-anchor">#</a> is_readable</h3> <p>判断给定文件名是否可读</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;?php
$filename = 'test.txt';
if (is_readable($filename)) {
    echo 'The file is readable';
} else {
    echo 'The file is not readable';
}
</code></pre></div><h3 id="file-exists"><a href="#file-exists" aria-hidden="true" class="header-anchor">#</a> file_exists</h3> <p>检查文件或目录是否存在</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;?php
$filename = '/path/to/foo.txt';

if (file_exists($filename)) {
    echo &quot;The file $filename exists&quot;;
} else {
    echo &quot;The file $filename does not exist&quot;;
}
</code></pre></div><h3 id="is-file"><a href="#is-file" aria-hidden="true" class="header-anchor">#</a> is_file</h3> <p>判断给定文件名是否为一个正常的文件。</p> <h3 id="is-dir"><a href="#is-dir" aria-hidden="true" class="header-anchor">#</a> is_dir</h3> <p>判断给定文件名是否是一个目录。</p> <h3 id="filesize-2"><a href="#filesize-2" aria-hidden="true" class="header-anchor">#</a> filesize</h3> <p>取得指定文件的大小，返回文件大小的字节数。</p> <div class="language- extra-class"><pre class="language-text"><code>echo filesize('xj.txt');
</code></pre></div><h3 id="file-put-contents"><a href="#file-put-contents" aria-hidden="true" class="header-anchor">#</a> file_put_contents</h3> <p>将一个字符串写入文件。</p> <table><thead><tr><th>参数</th> <th>说明</th></tr></thead> <tbody><tr><td>参数一</td> <td>文件名</td></tr> <tr><td>参数二</td> <td>写入的字符串</td></tr> <tr><td>参数三</td> <td>FILE_APPEND：如果文件 <code>filename</code> 已经存在，追加数据而不是覆盖。<br>LOCK_EX：在写入时获得一个独占锁。</td></tr></tbody></table> <h3 id="file-get-content"><a href="#file-get-content" aria-hidden="true" class="header-anchor">#</a> file_get_content</h3> <p>将整个文件读入一个字符串，如果打开远程文件需要开启php.ini中的 <code>allow_url_fopen</code> 选项。</p> <h3 id="filemtime"><a href="#filemtime" aria-hidden="true" class="header-anchor">#</a> filemtime</h3> <p>本函数返回文件中的数据块上次被写入的时间，也就是说，文件的内容上次被修改的时间。</p> <p>下面是缓存文件的操作代码，实际开发中的缓存控制还要注意很多细节，下面是核心思路代码。</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;?php
//缓存文件存在并且没有过期时使用缓存文件
if (is_file('1.cache.php') &amp;&amp; filemtime('1.cache.php') &gt; (time() - 10)) {
    include '1.cache.php';
} else {
    //开启缓存区并保存解析数据到缓存文件
    ob_start();
    include '1.blade.php';
    $content = ob_get_clean();
    echo $content;
    file_put_contents('1.cache.php', $content);
}
</code></pre></div><h3 id="var-export"><a href="#var-export" aria-hidden="true" class="header-anchor">#</a> var_export</h3> <p>输出或返回一个变量的字符串表示。</p> <p>下面是将数组保存到文件中的代码，并支持include 获取数组数据。</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;?php
$user = [
    ['name'=&gt;'向军大叔'],
    ['name'=&gt;'小明']
];
$content =var_export($user,true);
file_put_contents('users.php','&lt;?php return '.$content.';');
</code></pre></div><h3 id="basename"><a href="#basename" aria-hidden="true" class="header-anchor">#</a> basename</h3> <p>返回路径中的文件名部分</p> <div class="language- extra-class"><pre class="language-text"><code>echo basename(__FILE__);
</code></pre></div><h3 id="dirname"><a href="#dirname" aria-hidden="true" class="header-anchor">#</a> dirname</h3> <p>返回路径中的目录部分</p> <div class="language- extra-class"><pre class="language-text"><code>echo dirname(__FILE__);
</code></pre></div><h3 id="mkdir"><a href="#mkdir" aria-hidden="true" class="header-anchor">#</a> mkdir</h3> <p>支持递归的目录创建，参数分别是：目录、权限位、递归创建</p> <div class="language- extra-class"><pre class="language-text"><code>mkdir('a/b/c',0755,true);
</code></pre></div><h3 id="rmdir"><a href="#rmdir" aria-hidden="true" class="header-anchor">#</a> rmdir</h3> <p>删除指定的目录，该目录必须是空的，而且要有相应的权限。</p> <div class="language- extra-class"><pre class="language-text"><code>rmdir('views');
</code></pre></div><h3 id="rename"><a href="#rename" aria-hidden="true" class="header-anchor">#</a> rename</h3> <p>重命名一个文件或目录，也可以进行文件移动。</p> <div class="language-, extra-class"><pre class="language-text"><code>// 将1.html更名为a.html
rename('1.html','a.html');

//移动文件1.html到目录houdunren中
rename('1.html','houdunren/1.html');
</code></pre></div><h3 id="copy"><a href="#copy" aria-hidden="true" class="header-anchor">#</a> copy</h3> <p>复制文件</p> <div class="language- extra-class"><pre class="language-text"><code>//复制1.blade.php到目录f中
copy('1.blade.php','f/1.blade.php');
</code></pre></div><h2 id="常用常量"><a href="#常用常量" aria-hidden="true" class="header-anchor">#</a> 常用常量</h2> <h3 id="dir"><a href="#dir" aria-hidden="true" class="header-anchor">#</a> __DIR__</h3> <p>获取文件所有目录。</p> <h3 id="file"><a href="#file" aria-hidden="true" class="header-anchor">#</a> __FILE__</h3> <p>获取文件的完整路径，包含文件名。</p> <h3 id="directory-separator"><a href="#directory-separator" aria-hidden="true" class="header-anchor">#</a> DIRECTORY_SEPARATOR</h3> <p>目录分隔符，在 Windows 中，斜线（<em>/</em>）和反斜线（\）都可以用作目录分隔符，但是在linux上使用<code>/</code>，此常量会自动根据系统设置为合适的分隔符。</p> <h2 id="文件遍历"><a href="#文件遍历" aria-hidden="true" class="header-anchor">#</a> 文件遍历</h2> <h3 id="opendir"><a href="#opendir" aria-hidden="true" class="header-anchor">#</a> opendir</h3> <p>opendir 函数类似于 fopen 操作方式，可能获取目录指针读取目录，下面是操作示例。</p> <div class="language- extra-class"><pre class="language-text"><code>$handle = opendir('../php');
while (false!==($file = readdir($handle))) {
    if (!in_array($file, ['.','..'])) {
        echo filetype($file).&quot;\t&quot;.$file.'&lt;br/&gt;';
    }
}
closedir($handle);
</code></pre></div><h3 id="scandir"><a href="#scandir" aria-hidden="true" class="header-anchor">#</a> scandir</h3> <p>列出指定路径中的文件和目录。</p> <div class="language- extra-class"><pre class="language-text"><code>foreach (scandir('../php') as $file) {
    if (!in_array($file, ['.','..'])) {
        echo filetype($file).&quot;\t\t&quot;.$file.'&lt;hr/&gt;';
    }
}
</code></pre></div><h3 id="glob使用"><a href="#glob使用" aria-hidden="true" class="header-anchor">#</a> glob使用</h3> <p>寻找与模式匹配的文件路径。</p> <p>参数顺序为：参数一文件路径，参数二选项标记</p> <p>下面是常用选项标记</p> <table><thead><tr><th>选项</th> <th>说明</th></tr></thead> <tbody><tr><td>GLOB_MARK</td> <td>在每个返回的项目中加一个斜线</td></tr> <tr><td>GLOB_NOSORT</td> <td>按照文件在目录中出现的原始顺序返回（不排序）</td></tr> <tr><td>GLOB_NOCHECK</td> <td>如果没有文件匹配则返回用于搜索的模式</td></tr> <tr><td>GLOB_ERR</td> <td>停止并读取错误信息（比如说不可读的目录），默认的情况下忽略所有错误</td></tr> <tr><td>GLOB_BRACE</td> <td>设置多个匹配模式，如：{*.php,*.txt}</td></tr></tbody></table> <p>遍历目录</p> <div class="language- extra-class"><pre class="language-text"><code>$files = glob('../../*');
print_r($files);
</code></pre></div><p>指定检索文件类型</p> <div class="language- extra-class"><pre class="language-text"><code>$files = glob('*.php', GLOB_ERR);
</code></pre></div><p>设置多个匹配模式</p> <div class="language- extra-class"><pre class="language-text"><code>$files = glob(&quot;{*.php,*.txt}&quot;, GLOB_BRACE);
print_r($files);
</code></pre></div><h3 id="目录大小"><a href="#目录大小" aria-hidden="true" class="header-anchor">#</a> 目录大小</h3> <div class="language- extra-class"><pre class="language-text"><code>function dirSize($dir):int
{
    $size= 0;
    foreach (glob($dir.'/*') as $file) {
        $size += is_file($file)?filesize($file):dirSize($file);
    }
    return $size;
}
echo round(dirSize('/home/vagrant')/1024/1024).'MB';
</code></pre></div><h3 id="删除目录"><a href="#删除目录" aria-hidden="true" class="header-anchor">#</a> 删除目录</h3> <div class="language- extra-class"><pre class="language-text"><code>function delDir($dir):bool
{
    if (!is_dir($dir)) {
        return true;
    }
    foreach (glob($dir.'/*') as $file) {
        is_file($file)?unlink($file):delDir($file);
    }
    return rmdir($dir);
}
delDir('../php2');
</code></pre></div><h3 id="复制目录"><a href="#复制目录" aria-hidden="true" class="header-anchor">#</a> 复制目录</h3> <div class="language- extra-class"><pre class="language-text"><code>function copyDir($dir, $to):bool
{
    is_dir($to) or mkdir($to, 0755, true);
    foreach (glob($dir.'/*') as $file) {
        $target = $to.'/'.basename($file);
        is_file($file)?copy($file, $target):copyDir($file, $target);
    }
    return true;
}
copyDir('../php', '../php2');
</code></pre></div><h3 id="移动目录"><a href="#移动目录" aria-hidden="true" class="header-anchor">#</a> 移动目录</h3> <p>移动目录分两步执行，第一步是复制目录，第二步是删除目录，所以使用上面两个函数的综合即可以。</p> <div class="language- extra-class"><pre class="language-text"><code>function moveDir($dir, $to):bool
{
    copyDir($dir, $to);
    return delDir($dir);
}
</code></pre></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://gitee.com/houdunren/code/edit/master/docs/php/6 文件与目录.md" target="_blank" rel="noopener noreferrer">帮助我们改善此页面！</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">7/6/2019, 8:37:16 AM</span></div></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.bc65c992.js" defer></script><script src="/assets/js/2.80ecb150.js" defer></script><script src="/assets/js/51.c0bb3a53.js" defer></script>
  </body>
</html>
